<div class="min-h-screen flex items-center justify-center p-6">
  <div class="w-full max-w-lg pc-cardx pc-shadow p-6">
    <div class="flex items-center gap-3">
      <div class="h-10 w-10 rounded-2xl bg-sky-500/15 border border-sky-500/20 flex items-center justify-center">
        <i class="ri-cloud-line text-2xl text-sky-400"></i>
      </div>
      <div>
        <div class="text-3xl font-extrabold">Register</div>
        <div class="text-slate-300">Buat akun PansaCloud</div>
      </div>
    </div>

    <div class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-3">
      <input id="name" class="pc-input" placeholder="Nama">
      <input id="email" class="pc-input" placeholder="Email">
      <input id="phone" class="pc-input sm:col-span-2" placeholder="No HP E.164 (contoh 62812...)">
      <input id="password" type="password" class="pc-input sm:col-span-2" placeholder="Password">
    </div>

    <div class="mt-4 flex items-center gap-3">
      <button id="btnReg" class="pc-btn w-40 bg-sky-600 border-transparent hover:bg-sky-500">
        <i class="ri-user-add-line"></i> Register
      </button>
      <a href="/login" class="text-slate-300 hover:text-white underline underline-offset-4">Login</a>
    </div>
  </div>
</div>

<script>
async function doRegister(){
  const name=$("#name").val().trim();
  const email=$("#email").val().trim();
  const phone_e164=$("#phone").val().trim();
  const password=$("#password").val();

  if(!name || !email || !phone_e164 || !password) return toastr.warning("Semua field wajib diisi");

  // overlay cuma dipakai kalau app.js tidak jalan di auth (layout final yang aku kasih)
  $("#pcOverlay").removeClass("hidden");

  try{
    const r = await $.ajax({
      url:"/api/register",
      method:"POST",
      contentType:"application/json",
      data: JSON.stringify({ name,email,phone_e164,password })
    });

    if(!r.ok) return toastr.error(r.msg||"Register gagal");
    toastr.success(r.msg||"Register berhasil");
    location.href = r.redirect || "/login";
  }catch(e){
    toastr.error("Terjadi kesalahan server");
  }finally{
    $("#pcOverlay").addClass("hidden");
  }
}

$("#btnReg").on("click", doRegister);
$("#password").on("keydown", e => { if(e.key==="Enter") doRegister(); });
</script>
